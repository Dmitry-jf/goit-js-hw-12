{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\n// - запит\n\nimport axios from \"axios\";\n\n\n\nexport async function getImagesByQuery(query, page) {\n  const params = {\n    q: query,\n    key: '52578833-1380a7e48419fcc1cc100434d',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  };\n\n  const response = await axios.get('https://pixabay.com/api/', { params })\n\n  return {\n    hits: response.data.hits,\n    totalHits: response.data.totalHits,\n  }\n}\n","// - розмітка\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport const gallery = document.querySelector(\".gallery\");\nexport const loader = document.querySelector(\".loader\");\nexport const loadMoreBtn = document.querySelector(\".loader-btn\")\n\nexport const lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 150,\n});\n\nexport function refreshLightbox() {\n  try {\n    lightbox.refresh();\n  } catch (err) {\n    console.warn(\"Lightbox refresh failed:\", err);\n  }\n}\n\nexport function createGallery(images) {\n return images\n     .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `\n<li class=\"photo-card\">\n  <a href=\"${largeImageURL}\" class=\"gallery-link\" aria-label=\"${tags}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <p class=\"info-item\"><b>Likes</b><span>${likes}</span></p>\n    <p class=\"info-item\"><b>Views</b><span>${views}</span></p>\n    <p class=\"info-item\"><b>Comments</b><span>${comments}</span></p>\n    <p class=\"info-item\"><b>Downloads</b><span>${downloads}</span></p>\n  </div>\n</li>`\n    ).join('');\n}\n  \n export function clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n  loader.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n  loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add(\"hidden\");\n}","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoadMoreButton,\n  gallery,\n  refreshLightbox,\n} from \"./js/render-functions.js\";\n\n\nconst refs = {\n  form: document.querySelector('.form'),\n   loadMoreBtn: document.querySelector(\".loader-btn\"),\n};\n\n\n\nconst Page_Size = 15;\nlet query = \"\";\nlet currentPage;\nlet totalPages = 0;\n\nhideLoadMoreButton();\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formData = new FormData(e.target);\n  query = formData.get(\"search-text\").trim();\n\n\n  if (!query) {\n    iziToast.warning({\n      title: \"\",\n      message: \"Please enter a search query.\",\n      position: \"topRight\",\n    });\n    e.target.reset();\n    return;\n  }\n\n  currentPage = 1;\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, currentPage)\n\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        title: \"\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n      return\n    }\n\n    const markup = createGallery(data.hits);\n    gallery.innerHTML = markup;\n        \n    refreshLightbox();\n \n    totalPages = Math.ceil(data.totalHits / Page_Size);\n\n    \n if (currentPage < totalPages) {\n      showLoadMoreButton();\n    } else {\n      iziToast.info({\n        title: \"\",\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n      hideLoadMoreButton();\n    }\n  } catch (err) {\n    console.error(\"Search error:\", err);\n    iziToast.error({\n      title: \"\",\n      message: \"An error occurred while fetching images. Please try again.\",\n      position: \"topRight\",\n    });\n  } finally {\n    hideLoader();\n  }\n\n  e.target.reset();\n});\n\n\nrefs.loadMoreBtn.addEventListener(\"click\", async () => {\n  \n    if (!query) return;\n    currentPage += 1;\n\n    showLoader();\n    hideLoadMoreButton();\n\n\n try {\n    const data = await getImagesByQuery(query, currentPage);\n   \n     if (!data.hits || data.hits.length === 0) {\n      iziToast.info({\n        title: \"\",\n        message: \"No more images found.\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    const markup = createGallery(data.hits);\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n\n    refreshLightbox();\n\n    try {\n      const firstCard = gallery.firstElementChild;\n      if (firstCard) {\n        const { height: cardHeight } = firstCard.getBoundingClientRect();\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: \"smooth\",\n        });\n      }\n    } catch (scrollErr) {\n      console.warn(\"Scroll adjustment failed:\", scrollErr);\n    }\n\n    if (currentPage >= totalPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: \"\",\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (err) {\n    console.error(\"Load more error:\", err);\n    iziToast.error({\n      title: \"\",\n      message: \"An error occurred while loading more images.\",\n      position: \"topRight\",\n    });\n  } finally {\n    hideLoader();\n  }\n});"],"names":["getImagesByQuery","query","page","params","response","axios","gallery","loader","loadMoreBtn","lightbox","SimpleLightbox","refreshLightbox","err","createGallery","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","refs","Page_Size","currentPage","totalPages","iziToast","data","markup","firstCard","cardHeight","scrollErr"],"mappings":"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"}